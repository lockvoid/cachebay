
> benchmarks@0.7.1 bench:api /Users/kochnev/Projects/Ferment/villus-cachebay/packages/benchmarks
> pnpm relay && rsbuild build && node dist/bench.cjs


> benchmarks@0.7.1 relay /Users/kochnev/Projects/Ferment/villus-cachebay/packages/benchmarks
> relay-compiler

[0m[34m[INFO] [0mQuerying files to compile...
[0m[34m[INFO] [0m[default] compiling...
[0m[34m[INFO] [0m[default] compiled documents: 5 reader, 4 normalization, 5 operation text
[0m[34m[INFO] [0mCompilation completed.
[0m[34m[INFO] [0mDone.
Rsbuild v1.5.17

info    build started...
ready   built in 0.04 s

File (node)                                       Size        
dist/bench.cjs                                    8.4 kB   
dist/bench_api_readQuery_bench_ts.cjs             1340.3 kB
dist/bench_api_materializeDocument_bench_ts.cjs   1340.7 kB
dist/bench_api_writeQuery_bench_ts.cjs            1345.9 kB
dist/bench_api_normalizeDocument_bench_ts.cjs     1346.2 kB
dist/bench_api_watchQuery_bench_ts.cjs            1348.3 kB

                                         Total:   6729.7 kB

[90mclk: ~3.58 GHz[0m
[90mcpu: Apple M3 Max[0m
[90mruntime: node 22.13.1 (arm64-darwin)[0m

benchmark                                                     avg (min … max) p75 / p99    (min … top 1%)
----------------------------------------------------------------------------- -------------------------------
• watchQuery:initial:cold
[90m----------------------------------------------------------------------------- -------------------------------[0m
cachebay.watchQuery:initial:cold(1000 users (100 pages of 10)) [1m[33m   1.66 s[0m[1m/iter[0m [90m   1.68 s[0m [36m    █   █[0m[33m [0m[35m           [0m
                                                            [90m([0m[36m1.58 s[0m[90m … [0m[35m1.78 s[0m[90m)[0m [90m   1.77 s[0m [36m▅  ▅█▅  █[0m[33m▅[0m[35m▅▅        ▅[0m
                                                      [90m([0m[33m 71.41 mb[0m[90m … [0m[33m462.64 mb[0m[90m) [0m[33m413.95 mb[0m [36m█▁▁███▁▁█[0m[33m█[0m[35m██▁▁▁▁▁▁▁▁█[0m

relay.subscribe:initial:cold(1000 users (100 pages of 10))     [1m[33m   1.16 s[0m[1m/iter[0m [90m   1.16 s[0m [36m █    [0m[33m [0m[35m              [0m
                                                            [90m([0m[36m1.14 s[0m[90m … [0m[35m1.24 s[0m[90m)[0m [90m   1.23 s[0m [36m ██   [0m[33m [0m[35m              [0m
                                                      [90m([0m[33m182.07 mb[0m[90m … [0m[33m189.47 mb[0m[90m) [0m[33m188.04 mb[0m [36m█████▁[0m[33m█[0m[35m▁▁▁█▁▁▁▁▁▁▁▁▁█[0m

[1msummary[0m
  [1m[36mrelay.subscribe:initial:cold(1000 users (100 pages of 10))[0m
   [32m1.43[0mx faster than [1m[36mcachebay.watchQuery:initial:cold(1000 users (100 pages of 10))[0m

• watchQuery:initial:hot
[90m----------------------------------------------------------------------------- -------------------------------[0m
cachebay.watchQuery:initial:hot(1000 users (100 pages of 10))  [1m[33m  8.36 ms[0m[1m/iter[0m [90m  7.84 ms[0m [36m █ [0m[33m [0m[35m                 [0m
                                                         [90m([0m[36m7.27 ms[0m[90m … [0m[35m20.97 ms[0m[90m)[0m [90m 15.63 ms[0m [36m █ [0m[33m [0m[35m                 [0m
                                                      [90m([0m[33m  7.65 mb[0m[90m … [0m[33m 12.46 mb[0m[90m) [0m[33m 10.00 mb[0m [36m▇█▄[0m[33m▁[0m[35m▁▁▁▁▁▁▁▁▁▁▁▂▁▁▁▁▁[0m

relay.subscribe:initial:hot(1000 users (100 pages of 10))      [1m[33m 19.29 ms[0m[1m/iter[0m [90m 18.68 ms[0m [36m   █[0m[33m [0m[35m                [0m
                                                        [90m([0m[36m16.75 ms[0m[90m … [0m[35m35.37 ms[0m[90m)[0m [90m 30.81 ms[0m [36m▆███[0m[33m [0m[35m                [0m
                                                      [90m([0m[33m  1.37 mb[0m[90m … [0m[33m 13.11 mb[0m[90m) [0m[33m  6.40 mb[0m [36m████[0m[33m▄[0m[35m▁▄▁▁▁▁▄▁▁▁▁▁▁▁▁▄[0m

[1msummary[0m
  [1m[36mcachebay.watchQuery:initial:hot(1000 users (100 pages of 10))[0m
   [32m2.31[0mx faster than [1m[36mrelay.subscribe:initial:hot(1000 users (100 pages of 10))[0m

• watchQuery:reactive
[90m----------------------------------------------------------------------------- -------------------------------[0m
cachebay.watchQuery:reactive(1000 users (100 pages of 10))     [1m[33m 32.98 ms[0m[1m/iter[0m [90m 32.18 ms[0m [36m        █   [0m[33m [0m[35m        [0m
                                                        [90m([0m[36m30.20 ms[0m[90m … [0m[35m51.22 ms[0m[90m)[0m [90m 34.86 ms[0m [36m█   █   █   [0m[33m [0m[35m        [0m
                                                      [90m([0m[33m446.79 kb[0m[90m … [0m[33m 14.41 mb[0m[90m) [0m[33m  8.73 mb[0m [36m█████▁▁████▁[0m[33m▁[0m[35m▁▁▁▁█▁▁█[0m

apollo.watch:reactive(1000 users (100 pages of 10))            [1m[33m232.63 ms[0m[1m/iter[0m [90m230.76 ms[0m [36m█         [0m[33m [0m[35m          [0m
                                                      [90m([0m[36m217.30 ms[0m[90m … [0m[35m320.58 ms[0m[90m)[0m [90m247.09 ms[0m [36m██        [0m[33m [0m[35m          [0m
                                                      [90m([0m[33m112.34 kb[0m[90m … [0m[33m 54.64 mb[0m[90m) [0m[33m 16.42 mb[0m [36m██▁███▁▁▁█[0m[33m▁[0m[35m█▁▁▁▁▁▁▁▁█[0m

relay.subscribe:reactive(1000 users (100 pages of 10))         [1m[33m 26.90 ms[0m[1m/iter[0m [90m 25.12 ms[0m [36m █ [0m[33m [0m[35m                 [0m
                                                        [90m([0m[36m24.13 ms[0m[90m … [0m[35m43.20 ms[0m[90m)[0m [90m 41.21 ms[0m [36m █ [0m[33m [0m[35m                 [0m
                                                      [90m([0m[33m  5.61 mb[0m[90m … [0m[33m  7.13 mb[0m[90m) [0m[33m  6.18 mb[0m [36m██▃[0m[33m▁[0m[35m▁▁▃▃▁▁▁▁▁▁▁▁▁▁▁▁▃[0m

[1msummary[0m
  [1m[36mrelay.subscribe:reactive(1000 users (100 pages of 10))[0m
   [32m1.23[0mx faster than [1m[36mcachebay.watchQuery:reactive(1000 users (100 pages of 10))[0m
   [32m8.65[0mx faster than [1m[36mapollo.watch:reactive(1000 users (100 pages of 10))[0m

• watchQuery:pagination
[90m----------------------------------------------------------------------------- -------------------------------[0m
cachebay.watchQuery:pagination(1000 users (100 pages of 10))   [1m[33m 12.46 ms[0m[1m/iter[0m [90m 15.41 ms[0m [36m       █▄  [0m[33m [0m[35m█        [0m
                                                         [90m([0m[36m4.43 ms[0m[90m … [0m[35m20.03 ms[0m[90m)[0m [90m 19.63 ms[0m [36m      ███▅ [0m[33m [0m[35m██   ▅ ▅ [0m
                                                      [90m([0m[33m601.37 kb[0m[90m … [0m[33m 14.09 mb[0m[90m) [0m[33m  5.07 mb[0m [36m▅▅█▅▅▅████▅[0m[33m█[0m[35m██████▅█▅[0m

apollo.watch:pagination(1000 users (100 pages of 10))          [1m[33m 37.14 ms[0m[1m/iter[0m [90m 41.95 ms[0m [36m █        [0m[33m [0m[35m          [0m
                                                        [90m([0m[36m29.45 ms[0m[90m … [0m[35m46.87 ms[0m[90m)[0m [90m 44.70 ms[0m [36m █   █    [0m[33m [0m[35m          [0m
                                                      [90m([0m[33m494.22 kb[0m[90m … [0m[33m 19.62 mb[0m[90m) [0m[33m  7.73 mb[0m [36m██▁▁▁██▁▁▁[0m[33m▁[0m[35m██▁▁████▁█[0m

[1msummary[0m
  [1m[36mcachebay.watchQuery:pagination(1000 users (100 pages of 10))[0m
   [32m2.98[0mx faster than [1m[36mapollo.watch:pagination(1000 users (100 pages of 10))[0m
